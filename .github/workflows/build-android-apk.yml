# 1. Force Java 17 (Required for modern SDK Manager)
sudo apt-get install openjdk-17-jdk -y

# 2. Establish the 'Latest' layout (The fix for "sdkmanager not found")
export ANDROID_HOME=$HOME/android-sdk
mkdir -p $ANDROID_HOME/cmdline-tools/latest
cd $ANDROID_HOME/cmdline-tools
wget https://dl.google.com/android/repository/commandlinetools-linux-11076708_latest.zip
unzip *.zip
mv cmdline-tools/* latest/

# 3. Pathing and Licenses
export PATH=$PATH:$ANDROID_HOME/cmdline-tools/latest/bin:$ANDROID_HOME/platform-tools
yes | sdkmanager --licenses

# 4. Specific Package Injection
sdkmanager "platforms;android-33" "build-tools;33.0.2" "ndk;25.2.9519653"

# 5. Buildozer Execution
buildozer android release
